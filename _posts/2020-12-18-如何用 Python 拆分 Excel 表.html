---
layout: post
status: publish
published: true
title: '如何用 Python 拆分 Excel 表'
excerpt: 'HOW TO 系列 No.19'
author:
  display_name: huahuoding
  login: huahuoding
  email: dinghuahuo@gmail.com
  url: ''
featured-image: 'https://cloud.huahuoding.com/images/2020/12/18/2020121823T970.jpeg'
featured-image-alt: '如何用 Python 拆分 Excel 表'
wx_url: 'http://mp.weixin.qq.com/s?__biz=MzIyMjEzMjMwMg==&mid=2650025133&idx=1&sn=98fd8299058a23f8a61a673584ea8ebb&chksm=f032ad8cc745249ad0bd865bcce91182f24754cd7a856ed1a0bb28b5d4e86c06efe56ab7c424#rd'
date: '2020-12-18 22:51:08 +0800'
date_gmt: '2020-12-18 22:51:08 +0800'
categories:
- 花火田丁
tags: []
comments: []
---

<div class="rich_media_wrp" id="img-content">
<h2 class="rich_media_title" id="activity-name">
                    
                    
                    
如何用 Python 拆分 Excel 表
                </h2>
<div class="rich_media_meta_list" id="meta_content">
<span class="rich_media_meta icon_appmsg_tag appmsg_title_tag" id="copyright_logo">原创</span>
<span class="rich_media_meta rich_media_meta_text">
<span class="rich_media_meta_link" datacanreward="0" datarewardsn="" datatimestamp="" id="js_author_name">花火田丁</span>
</span>
<span class="rich_media_meta rich_media_meta_nickname" id="profileBt">
<a href="javascript:void(0);" id="js_name">
                        花火田丁                      </a>
<div class="profile_container" id="js_profile_qrcode" style="display:none;">
<div class="profile_inner">
<strong class="profile_nickname">花火田丁</strong>
<img alt="" class="profile_avatar" id="js_profile_qrcode_img" src=""/>
<p class="profile_meta">
<label class="profile_meta_label">微信号</label>
<span class="profile_meta_value">huahuoding</span>
</p>
<p class="profile_meta">
<label class="profile_meta_label">功能介绍</label>
<span class="profile_meta_value">对与错，是与非，下一秒钟你又在哪里？这里有一切关于「relativity」的故事</span>
</p>
</div>
<span class="profile_arrow_wrp" id="js_profile_arrow_wrp">
<i class="profile_arrow arrow_out"></i>
<i class="profile_arrow arrow_in"></i>
</span>
</div>
</span>
<em class="rich_media_meta rich_media_meta_text" id="publish_time"></em>
</div>
<div class="article-tag__list single-tag__wrp js_single" data-len="1" id="js_tags">
<div class="article-tag-card__left">
<div class="article-tag-card__title">收录于话题</div>
<div class="article-tag__item-wrp no-active js_tag" data-album_id="1328469313900314626" data-tag_id="" data-url="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzIyMjEzMjMwMg==&amp;action=getalbum&amp;album_id=1328469313900314626#wechat_redirect">
<span class="article-tag__item">#HOW TO 系列</span>
</div>
</div>
<div class="article-tag-card__right">21个</div>
</div>
<div class="rich_media_content" id="js_content" style="visibility: visible;">
<section style="white-space: normal;"><section powered-by="xiumi.us"><section><section><section><section powered-by="xiumi.us"><section><section><section><qqmusic albumid="00020FCv12X7MJ" albumurl="https://y.gtimg.cn/music/photo_new/T002R68x68M00000020FCv12X7MJ.jpg" audiourl="http://isure6.stream.qqmusic.qq.com/C200002xx3T20B3zzy.m4a?guid=2000001731&amp;vkey=5BBF1D06E4CA06C171A74F0267F8C36E8706859B6477789704AAD97745A69792507F4B568FA2E01A9CF585674661557AF1FD02105A2B4778&amp;uin=&amp;fromtag=50" class="js_editor_qqmusic qqmusic_iframe js_uneditable custom_select_card" data-pluginname="insertaudio" jumpurlkey="" mid="002WDLcE4dX65o" music_name="Mandy" musicid="4924886" musictype="1" otherid="002WDLcE4dX65o" play_length="200" singer="Westlife - Turnaround" src="/cgi-bin/readtemplate?t=tmpl/qqmusic_tmpl&amp;singer=Westlife%20-%20Turnaround&amp;music_name=Mandy&amp;albumurl=https%3A%2F%2Fy.gtimg.cn%2Fmusic%2Fphoto_new%2FT002R68x68M00000020FCv12X7MJ.jpg&amp;musictype=1"></qqmusic></section><p style="text-align: center;"><img class="rich_pages" data-ratio="0.7078125" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/KFEEzuYoIv0K5ib1VvbRNqzfTgfYeyWdto85S5ibwby35N3icJy5TeTtsoOyiaGV0BbNXll3vVaLXgIEgibCX8KiaXbA/640?wx_fmt=jpeg" data-type="jpeg" data-w="1280" src="https://cloud.huahuoding.com/images/2020/12/18/20201218q6584U.jpeg" style=""/></p><p style="text-indent: 0em;"><span style="color: rgb(136, 136, 136);text-indent: 0em;">题图摄于上海，By 町</span></p></section></section></section></section></section></section></section></section><section style="font-size: 16px;white-space: normal;max-width: 100%;box-sizing: border-box;color: rgb(62, 62, 62);background-color: rgb(255, 255, 255);word-wrap: break-word !important;"><section powered-by="xiumi.us" style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box;word-wrap: break-word !important;"><section><blockquote style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-top: 1.5em;margin-right: 1.5em;margin-bottom: 1.5em;padding-left: 1.5em;color: rgb(102, 102, 102);border-left-width: 4px;border-left-color: rgb(153, 153, 153);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'><p style="-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;text-rendering: optimizeLegibility !important;">本文旨在于提供一种零基础写代码的思路，即，完全没接触过代码的同学，如何通过代码去实现一些自己想要的功能，因此，高手请绕行😄</p></blockquote><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>有一个总表，比如产品销量统计表，需要将这个总表按照产品名称拆分成各个产品销量的子表。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>当然也可以用最原始的办法去手工操作，但是如果每个月都要去做这样的事情，并不是一次性的操作，那么就要考虑自动化了。方法有很多，你也可以用 VBA，今天简单介绍一下如何用 Python 去处理。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>写脚本代码，还是比较轻松愉快的，不像做系统开发，更多的时间花在「想」上，比如考虑系统架构、考虑业务逻辑、考虑合适的技术……等等，最后才是编码过程。而写脚本呢，有时候甚至有点反其道而行之，尤其是对于初学者来说，先写出一个具备核心功能的可运行版本，即便很粗糙，也没关系。本文会着重于「从手工操作的逻辑去实现代码」，而不仅仅是代码本身。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>「用 Python 拆分 Excel 表」，关键词在于「拆分」，拆分的业务逻辑是什么呢？我们通过想象一下手工操作会如何进行，来确定这个逻辑。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>首先，我们需要知道这个表里有哪些产品 ——— 即，一个产品清单，手工会怎么操作？选中产品名称这一列，然后用 Excel 的数据去重的功能，就得到了一个不重复的产品名称的清单了。到代码里，同理，我们首先让程序读取这张表里的所有数据，然后逐一把产品名称存到一个 List 里，注意，每次存进去之前，判断一下 List 里是否已经存在这个产品名称了。</p><pre style='-webkit-font-smoothing: antialiased;margin-top: 1.5em;margin-bottom: 1.5em;font-stretch: normal;font-size: 18px;font-family: Menlo, Consolas, "DejaVu Sans Mono", "Courier New", "andale mono", "lucida console", monospace;line-height: 1.5;text-align: left;overflow-x: scroll;color: rgb(211, 189, 126);background-color: rgb(32, 32, 32);padding: 10pt 15pt;border-top-left-radius: 3px;border-top-right-radius: 3px;border-bottom-right-radius: 3px;border-bottom-left-radius: 3px;text-rendering: optimizeLegibility !important;'><code style="-webkit-font-smoothing: antialiased;font-stretch: normal;font-size: 16.200000762939453px;font-family: Menlo, monospace;line-height: 1.5;text-rendering: optimizeLegibility !important;">prd_name_list <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> []<br/><br/><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">for</span> i <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">range</span>(rows):<br/>	temp <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> data[<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">'prd_name'</span>][i]	<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">#prd_name为表格中产品名称的列名<br/></span>	<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">if</span> temp <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">not</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> prd_name_list:<br/>		prd_name_list.append(temp)</code></pre><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>于是，我们得到了一个产品清单 <code style="-webkit-font-smoothing: antialiased;font-stretch: normal;font-size: 16.200000762939453px;font-family: Menlo, monospace;line-height: 1.5;padding: 0.2em 0.4em;background-color: rgb(225, 233, 237);text-rendering: optimizeLegibility !important;">prd_name_list</code></p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>接下来，我们需要做的是，根据这个产品清单里的每一个产品名称，去找到总表与它匹配的行，把这些行保存起来，存成一个新的表。那么最外面，是一个 <code style="-webkit-font-smoothing: antialiased;font-stretch: normal;font-size: 16.200000762939453px;font-family: Menlo, monospace;line-height: 1.5;padding: 0.2em 0.4em;background-color: rgb(225, 233, 237);text-rendering: optimizeLegibility !important;">prd_name_list</code>的循环，内层又是一次读总表的过程，同上：</p><pre style='-webkit-font-smoothing: antialiased;margin-top: 1.5em;margin-bottom: 1.5em;font-stretch: normal;font-size: 18px;font-family: Menlo, Consolas, "DejaVu Sans Mono", "Courier New", "andale mono", "lucida console", monospace;line-height: 1.5;text-align: left;overflow-x: scroll;color: rgb(211, 189, 126);background-color: rgb(32, 32, 32);padding: 10pt 15pt;border-top-left-radius: 3px;border-top-right-radius: 3px;border-bottom-right-radius: 3px;border-bottom-left-radius: 3px;text-rendering: optimizeLegibility !important;'><code style="-webkit-font-smoothing: antialiased;font-stretch: normal;font-size: 16.200000762939453px;font-family: Menlo, monospace;line-height: 1.5;text-rendering: optimizeLegibility !important;"><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">for</span> prd <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> prd_name_list:<br/>	<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">for</span> i <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">range</span>(rows):<br/>		<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">if</span> data[<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">'prd_name'</span>] <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">==</span> prd:		<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;"># 将此行数据保存起来<br/></span></code></pre><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>到这里，主体逻辑其实已经完成了，很简单是不是，其他的都是一些工具类了，用来辅助实现主体逻辑。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>那么，我们还剩下哪些工具需要做呢？罗列一下：</p><ol class="list-paddingleft-2" style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-right: 3em;margin-bottom: 1.5em;margin-left: 1.5em;padding-left: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'><li style="-webkit-font-smoothing: antialiased;margin-bottom: 0.75em;margin-top: 0.75em;text-rendering: optimizeLegibility !important;"><p>读入 Excel 文件</p></li><li style="-webkit-font-smoothing: antialiased;margin-bottom: 0.75em;margin-top: 0.75em;text-rendering: optimizeLegibility !important;"><p>读取 Excel 表中所有行</p></li><li style="-webkit-font-smoothing: antialiased;margin-bottom: 0.75em;margin-top: 0.75em;text-rendering: optimizeLegibility !important;"><p>保存我们筛选出来的行数据</p></li><li style="-webkit-font-smoothing: antialiased;margin-bottom: 0.75em;margin-top: 0.75em;text-rendering: optimizeLegibility !important;"><p>写入到新的 Excel 表文件</p></li></ol><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>拆分成单个工具后，通过搜索引擎查找关键词或者求助专业人士，很容易找到实现的方法。完整的代码如下：</p><pre style='-webkit-font-smoothing: antialiased;margin-top: 1.5em;margin-bottom: 1.5em;font-stretch: normal;font-size: 18px;font-family: Menlo, Consolas, "DejaVu Sans Mono", "Courier New", "andale mono", "lucida console", monospace;line-height: 1.5;text-align: left;overflow-x: scroll;color: rgb(211, 189, 126);background-color: rgb(32, 32, 32);padding: 10pt 15pt;border-top-left-radius: 3px;border-top-right-radius: 3px;border-bottom-right-radius: 3px;border-bottom-left-radius: 3px;text-rendering: optimizeLegibility !important;'><code style="-webkit-font-smoothing: antialiased;font-stretch: normal;font-size: 16.200000762939453px;font-family: Menlo, monospace;line-height: 1.5;text-rendering: optimizeLegibility !important;"><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">import</span> pandas <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">as</span> pd<br/><br/><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;"># 读入 Excel 文件<br/></span>data <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> pd.read_excel(<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">'d:</span><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">\\</span><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">test.xls'</span>)<br/>rows <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> data.shape[<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">0</span>]<br/><br/><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;"># 获取产品清单<br/></span>prd_name_list <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> []<br/><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">for</span> i <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">range</span>(rows):<br/>	temp <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> data[<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">'prd_name'</span>][i]		<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">#prd_name为表格中产品名称的列名<br/></span>	<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">if</span> temp <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">not</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> prd_name_list:<br/>		prd_name_list.append(temp)<br/><br/><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;"># 根据产品名称筛选行并保存到新的文件<br/></span><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">for</span> prd <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> prd_name_list:<br/>	df <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> pd.DataFrame()<br/>	<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">for</span> i <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">in</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">range</span>(rows):<br/>		<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">if</span> data[<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">'prd_name'</span>] <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">==</span> prd:		<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;"># 将此行数据保存起来<br/></span>			df <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> pd.concat([df, data.iloc[[i],:]], <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">axis</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">0</span>, <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">ignore_index</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">True</span>)                 <br/><br/>    df.to_excel(prd<span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">+</span><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">'.xls'</span>, <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">sheet_name</span><span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span>prd, <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">index</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">=</span> <span style="-webkit-font-smoothing: antialiased;text-rendering: optimizeLegibility !important;">False</span>)</code></pre><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>到这里，基本的功能已经实现了。但运行过程中可能还会遇到其他问题，比如，Python 缺少某些模块的问题、常见的中文编码的问题等等，那就对症下药，挨个去解决就行了。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>在顺利运行出结果之后，我们再来想想有哪些可以延伸的功能，比如，如果要统计出符合某个条件的产品销量总和并存成一张新表，那怎么通过 Python 来实现呢？Python 在处理 Excel 上还可以做哪些呢，是不是可以画个图表？</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>另外就是代码中可以优化的地方，比如，可以封装成一个函数，文件名通过变量传进来，这样可以方便地处理有多个源文件的情况，那如果是要处理一个文件夹里的所有 Excel 文件呢？那我们就需要学习 Python 关于文件系统的功能 —— 通过 os.path 遍历文件夹并获取文件名。再延伸一下，如果文件中有英文需要翻译的，Python 可以调用翻译 API 直接去实现……</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>就这样，我们从开始的一个小功能，实现自己的核心需求后，慢慢延伸和扩展，或许就变成了一个 Python 的练手项目。其实，任何一种编程语言都是如此，我始终认为，上手最重要，只有敲开了这扇门，然后才有机会去细细发掘门背后的奥秘。不要指望一口气吃成一个胖子，也不要等满汉全席都做完了才开吃，两种极端都可不取。</p><p style='text-align: start;white-space: normal;-webkit-font-smoothing: antialiased;margin-bottom: 1.5em;caret-color: rgba(0, 0, 0, 0.8);color: rgba(0, 0, 0, 0.8);font-family: Georgia, Cambria, "Times New Roman", Times, serif;font-size: 18px;text-rendering: optimizeLegibility !important;'>Python 不难，从实现自己的一个小需求开始吧！关于 Python 爬虫，可以参见之前的一篇文章 <a data-itemshowtype="0" data-linktype="2" href="http://mp.weixin.qq.com/s?__biz=MzIyMjEzMjMwMg==&amp;mid=2650023988&amp;idx=1&amp;sn=8933a9a196cf8adf058832d5a6bbf4c4&amp;chksm=f032a915c7452003db1cd83d9f244f86d5ad8b060b0da47b3bd76a246530e75a032734fbaf7c&amp;scene=21#wechat_redirect" tab="innerlink" target="_blank" textvalue="如何用 Python 写一个最简单的爬虫">如何用 Python 写一个最简单的爬虫</a></p><p style="max-width: 100%;box-sizing: border-box;min-height: 1em;margin-left: 0px;margin-right: 0px;word-wrap: break-word !important;"><span style="max-width: 100%;text-align: center;box-sizing: border-box !important;word-wrap: break-word !important;"></span></p><section style="margin-bottom: 16px;padding: 8px;font-family: inherit;border-width: 1px;border-style: solid;border-color: rgb(226, 226, 226);box-shadow: rgb(226, 226, 226) 0px 16px 1px -13px;font-size: 1.5em;line-height: 1;text-decoration: inherit;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style='margin-bottom: 1em;width: 4em;height: 4em;float: left;border-top-left-radius: 50%;border-top-right-radius: 50%;border-bottom-right-radius: 50%;border-bottom-left-radius: 50%;background-image: url("https://cloud.huahuoding.com/images/2020/12/18/20201218P8Y220.jpeg");background-size: cover;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;background-position: 50% 50%;background-repeat: no-repeat no-repeat;'><br/></section><section style="text-align: right;float: right;display: inline;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="margin-right: 3px;display: inline-block;vertical-align: top;width: 1.2em;line-height: 1.2;font-size: 0.5em;font-family: inherit;text-decoration: inherit;color: rgb(120, 124, 129);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">撒欢吧</section></section><section style="margin-right: 3px;display: inline-block;vertical-align: top;width: 1.2em;line-height: 1.2;font-size: 0.5em;font-family: inherit;text-decoration: inherit;color: rgb(120, 124, 129);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">谈理想</section></section><section style="margin-right: 3px;display: inline-block;vertical-align: top;width: 1.2em;line-height: 1.2;font-size: 0.5em;font-family: inherit;text-decoration: inherit;color: rgb(120, 124, 129);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">聊人生</section></section><section style="margin-right: 3px;display: inline-block;vertical-align: top;width: 1.2em;line-height: 1.2;font-size: 0.5em;font-family: inherit;text-decoration: inherit;color: rgb(120, 124, 129);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">讲故事</section></section><section style="margin-right: 16px;display: inline-block;vertical-align: top;width: 1.1em;line-height: 1.2;font-size: 0.7em;font-family: inherit;text-decoration: inherit;color: rgb(255, 255, 255);border-color: rgb(249, 110, 87);background-color: rgb(95, 156, 239);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">相对论</section></section><section style="display: inline-block;vertical-align: top;width: 1.2em;line-height: 1em;font-family: inherit;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">花火田丁</section></section></section><section style="clear: both;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="line-height: 1.6em;font-size: 0.5em;font-family: inherit;text-decoration: inherit;max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">微信号：huahuoding</section></section><section style="line-height: 1.6em;font-size: 0.5em;font-family: inherit;text-decoration: inherit;color: rgb(120, 124, 129);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">花火田丁</section></section><section style="line-height: 1.6em;font-size: 0.5em;font-family: inherit;text-decoration: inherit;color: rgb(120, 124, 129);max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;"><section style="max-width: 100%;box-sizing: border-box !important;word-wrap: break-word !important;">不折腾不人生</section></section></section></section></section></section></section></section>
</div>
<script nonce="1331953246" type="text/javascript">
                    var first_sceen__time = (+new Date());

                    if ("" == 1 && document.getElementById('js_content')) {
                        document.getElementById('js_content').addEventListener("selectstart",function(e){ e.preventDefault(); });
                    }

                    
                    (function(){
                        if (navigator.userAgent.indexOf("WindowsWechat") != -1){
                            var link = document.createElement('link');
                            var head = document.getElementsByTagName('head')[0];
                            link.rel = 'stylesheet';
                            link.type = 'text/css';
                            link.href = "//res.wx.qq.com/mmbizwap/zh_CN/htmledition/style/page/appmsg_new/winwx531a40.css";
                            head.appendChild(link);
                        }
                    })();
                </script>
<div id="js_sponsor_ad_area"></div>
<div class="read-more__area" id="js_more_read_area" style="display:none;">
</div>
<div class="reward_area tc reward_area_primary reward_area_carry_whisper" id="js_reward_area" style="display:none;">
<div class="reward-avatar" id="js_reward_avatar" style="display: none;">
<img alt="" id="js_reward_author_head" src=""/>
</div>
<div class="reward-author" id="js_reward_author" style="display: none;">花火田丁</div>
<p class="reward_tips js_reward_wording">艺术源于生活</p>
<p class="reward_button_wrp">
<span class="reward_pop_panel" id="js_author_reward_qrcode">
<img alt="赞赏二维码" id="js_author_reward_qrcode_img" src=""/>
<strong>微信扫一扫赞赏作者</strong>
</span>
<a class="reward_button weui-btn" href="##" id="js_reward_link"><span id="js_reward_link_text">赞赏</span></a>
</p>
<div class="reward_whisper_wrp" id="js_reward_whisper" style="display: none;">
<div class="reward_whisper_word">已喜欢，<a class="reward_whisper_link" href="javascript:;" id="js_show_whisper_dialog">对作者说句悄悄话</a></div>
</div>
<div id="js_reward_whisper_dialog" style="display: none;">
<div class="like_comment_primary_wrp editing">
<div class="like_comment_primary_inner">
<div class="like_comment_primary_hd">
<div class="like_comment_primary_hd_side">
<button class="like_comment_primary_cancel" id="js_hide_whisper_dialog">
            取消<i class="weui-icon-close-thin"></i>
</button>
</div>
<h4 class="like_comment_primary_title">发送给作者</h4>
<div class="like_comment_primary_hd_side">
<button class="like_comment_primary_btn" disabled="disabled" id="js_whisper_send">发送</button>
</div>
</div>
<div class="like_comment_primary_bd">
<textarea class="like_comment_textarea weui-textarea" id="js_whisper_text" placeholder="说句悄悄话"></textarea>
</div>
<span class="like_comment_msg" id="js_whisper_msg" style="visibility: hidden;">最多40字，当前共<span id="js_whisper_current_cnt"></span>字</span>
</div>
</div>
<div class="like_comment_primary_mask" id="js_whisper_dialog_mask"></div>
</div>
<div class="reward_area_inner" id="js_reward_inner" style="display:none;">
<p class="weui-loadmore weui-loadmore_line reward_user_tips" id="js_reward_total_parent">
<span class="weui-loadmore__tips">
<a href="javascript:;" id="js_reward_total"></a> <span id="js_reward_total_text">人赞赏</span>
</span>
</p>
<div class="reward_user_list" id="js_reward_list"></div>
<div class="simple_pagination" id="js_reward_pagination" style="display: none;">
<button class="btn_sp_prev js_reward_pagination_prev" disabled="">上一页</button>
<span class="sp_page_num_area">
<a class="sp_page_current js_reward_pagination_curpage" href="javascript:;">1</a>/<span class="sp_page_num js_reward_pagination_totalpage">3</span>
</span>
<button class="btn_sp_next js_reward_pagination_next">下一页</button>
</div>
</div>
</div>
<div class="reward_qrcode_area reward_area tc" id="js_reward_qrcode" style="display:none;">
<p class="tips_global">长按二维码向我转账</p>
<p class="reward_tips">艺术源于生活</p>
<span class="reward_qrcode_img_wrp"><img class="reward_qrcode_img" id="js_reward_qrcode_img"/></span>
<p class="tips_global">受苹果公司新规定影响，微信 iOS 版的赞赏功能被关闭，可通过二维码转账支持公众号。</p>
</div>
</div>